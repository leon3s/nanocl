name: docktron
type: namespace
git_repositories:
  - name: express-test-deploy
    url: https://github.com/leon3s/express-test-deploy
    update_on:
      push:
        branches:
          - development

clusters:
  - name: dev
    domain: dev
    variables:
      env:
        NODE_ENV: production

  - name: staging
    domain: staging
    variables:
      env:
        NODE_ENV: production

  - name: production
    variables:
      env:
        NODE_ENV: production

networks:
  - name: docktron-backend
  - name: docktron-frontend

cargoes:
  - name: docktron-db
    image: mongodb:latest
    network: docktron-backend

  - name: docktron-api
    network: docktron-backend
    proxy_config:
      domain: "api.docktron.org"
      hosts:
        - 172.19.205.44
    git_repository: docktron-api
    env:
      - NODE_ENV={NODE_ENV}
      - DB_URL={DB_URL}

  - name:  docktron-landing
    network: docktron-frontend
    proxy_config:
      domain: "docktron.org"
      hosts:
        - 172.19.205.44
    git_repository: docktron-landing
    env:
      - NODE_ENV={NODE_ENV}
      - DB_URL={DB_URL}
