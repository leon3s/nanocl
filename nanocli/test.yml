name: docktron

git_repositories:
  - name: docktron-api
    url: https://github.com/leon3s/docktron-api
  - name: docktron-landing
    url: https://github.com/leon3s/docktron-landing

clusters:
  - name: dev
    env:
      NODE_ENV: production
      DB_URL: dev-docktron-db
    update_on:
      push:
        branches:
          - development

networks:
  - name: "{cluster.name}-docktron-backend"
  - name: docktron-frontend

cargos:
  - name: docktron-db
    image: mongodb:latest
    network: docktron-backend

  - name: docktron-api
    network: docktron-backend
    domain: "{cluster.name}-api.docktron.org"
    proxy_config:
      host: 172.19.205.44
    git_repository: docktron-api
    env:
      - NODE_ENV={NODE_ENV}
      - DB_URL={DB_URL}

  - name:  docktron-landing
    network: docktron-frontend
    domain: "{cluster.name}.docktron.org"
    proxy_config:
      host: 172.19.205.44
    git_repository: docktron-landing
    env:
      - NODE_ENV={NODE_ENV}
      - DB_URL={DB_URL}
